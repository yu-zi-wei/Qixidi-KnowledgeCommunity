<template>
  <div class="home-top-index">
    <el-tabs v-model="special">
      <el-tab-pane label="专 栏" name="special">
        <el-row>
          <el-col :span="10">
            <el-input v-model="queryParams.specialName" placeholder="请输入标题关键字"
                      suffix-icon="el-icon-el-input__icon el-icon-search"></el-input>
          </el-col>
          <el-col :span="3" class="fl-right">
            <el-button type="primary" size="small" plain @click="add">创建专栏
              <i class="el-icon-plus el-icon--right"></i></el-button>
          </el-col>
        </el-row>
        <el-skeleton class="mt-10" v-if="loading" :rows="4" animated/>
        <ul class="content" v-if="specialUserList.length>0 && !loading">
          <li v-for="item of specialUserList" class="contentItem">
            <div class="flex-space-between">
              <div class="flex-left">
                <div>
                  <el-image v-if="item.cover" :src="item.cover" fit="cover"
                            style="height: 80px;width: 100px"></el-image>
                  <el-image v-else src="/img/shu.jpg" fit="cover" style="height: 80px;width: 100px"></el-image>
                </div>
                <div class="ml-10">
                  <div @click="specialIndex(item)">
                    <p class="details-1 font-bold text-underline-hover cursor-pointer">{{ item.specialName }}</p>
                    <p class="details-2">{{ item.specialIntroduce }}</p>
                  </div>
                  <div class="details-3 color-grey-2">
                    <span v-text="$utils.parseTime(item.createTime, '{y}-{m}-{d}')"></span>
                    <span class="ml-4 mr-4">.</span>
                    <span>{{ item.includedCount }} 篇文章</span>
                  </div>
                </div>
              </div>
              <div>
                <el-dropdown trigger="click">
                  <span class="left-loc-cl" title="更多"><i class="el-icon-more"></i></span>
                  <el-dropdown-menu slot="dropdown">
                    <el-dropdown-item @click.native="administration(item)">管理内容</el-dropdown-item>
                    <el-dropdown-item @click.native="edit(item)">更新简介</el-dropdown-item>
                    <el-dropdown-item @click.native="deletes(item)">删除</el-dropdown-item>
                  </el-dropdown-menu>
                </el-dropdown>
              </div>
            </div>
            <hr class="hr-item"/>
          </li>
        </ul>
        <div v-if="specialUserList.length==0 && !loading" style="text-align: center;min-height: 100px;margin-top: 30px">
          <div>
            <svg t="1667825747332" class="icon" viewBox="0 0 1239 1024" version="1.1"
                 xmlns="http://www.w3.org/2000/svg"
                 p-id="1560" width="50" height="50">
              <path
                d="M1215.146667 961.194667c0 35.498667-240.298667 62.805333-540.672 62.805333-297.642667 0-540.672-27.306667-540.672-62.805333 0-35.498667 240.298667-62.805333 540.672-62.805334 297.642667 0 540.672 27.306667 540.672 62.805334"
                fill="#DFDFDF" p-id="1561"></path>
              <path
                d="M95.573333 245.76l-5.461333-5.461333c2.730667-2.730667 8.192-5.461333 13.653333-10.922667l5.461334 5.461333c-5.461333 2.730667-8.192 8.192-13.653334 10.922667z m19.114667-13.653333l-2.730667-8.192c8.192-5.461333 19.114667-10.922667 27.306667-16.384l2.730667 8.192c-8.192 5.461333-19.114667 10.922667-27.306667 16.384z m906.581333 494.250666h-24.576v-8.192h32.768v8.192c-2.730667-2.730667-5.461333 0-8.192 0z m16.384-2.730666v-8.192c10.922667 0 21.845333 0 32.768-2.730667v8.192c-10.922667 2.730667-21.845333 2.730667-32.768 2.730667z m-49.152 0c-10.922667 0-21.845333-2.730667-32.768-5.461334l2.730667-8.192c10.922667 2.730667 19.114667 2.730667 32.768 5.461334l-2.730667 8.192z m-40.96-8.192c-10.922667-2.730667-21.845333-5.461333-30.037333-10.922667l2.730667-8.192c8.192 5.461333 19.114667 8.192 30.037333 10.922667l-2.730667 8.192z m-38.229333-13.653334c-10.922667-5.461333-19.114667-13.653333-27.306667-21.845333l5.461334-5.461333c5.461333 8.192 13.653333 13.653333 24.576 19.114666l-2.730667 8.192z m-30.037333-30.037333c-5.461333-8.192-10.922667-19.114667-13.653334-30.037333l8.192-2.730667c2.730667 10.922667 5.461333 19.114667 13.653334 27.306667l-8.192 5.461333z m-16.384-38.229333c0-5.461333-2.730667-13.653333-2.730667-21.845334v-13.653333h8.192v10.922667c0 5.461333 0 13.653333 2.730667 19.114666l-8.192 5.461334z m8.192-40.96h-8.192c0-10.922667 2.730667-21.845333 5.461333-32.768l8.192 2.730666c-2.730667 10.922667-2.730667 19.114667-5.461333 30.037334z m8.192-38.229334l-8.192-2.730666c2.730667-10.922667 8.192-19.114667 10.922666-30.037334l8.192 2.730667c-2.730667 10.922667-8.192 19.114667-10.922666 30.037333z m16.384-38.229333l-8.192-2.730667c5.461333-8.192 8.192-19.114667 13.653333-30.037333l8.192 2.730667c-5.461333 10.922667-10.922667 21.845333-13.653333 30.037333z m16.384-35.498667l-8.192-2.730666c5.461333-8.192 10.922667-19.114667 16.384-27.306667l8.192 5.461333c-5.461333 5.461333-10.922667 13.653333-16.384 24.576z m19.114666-35.498666l-8.192-5.461334c5.461333-8.192 10.922667-19.114667 16.384-27.306666l5.461334 5.461333c-2.730667 8.192-8.192 19.114667-13.653334 27.306667z m21.845334-32.768l-5.461334-5.461334c5.461333-8.192 10.922667-16.384 19.114667-27.306666l5.461333 5.461333c-5.461333 8.192-13.653333 16.384-19.114666 27.306667z m24.576-35.498667l-5.461334-5.461333c5.461333-8.192 13.653333-16.384 19.114667-27.306667l5.461333 5.461333c-8.192 10.922667-13.653333 19.114667-19.114666 27.306667z m21.845333-32.768l-5.461333-5.461333c5.461333-8.192 13.653333-16.384 19.114666-24.576l5.461334 5.461333c-5.461333 8.192-10.922667 16.384-19.114667 24.576z m27.306667-30.037333l-5.461334-5.461334c5.461333-8.192 13.653333-16.384 19.114667-24.576l5.461333 5.461334c-8.192 8.192-13.653333 16.384-19.114666 24.576z m24.576-32.768l-5.461334-5.461334c5.461333-8.192 13.653333-16.384 21.845334-24.576l5.461333 5.461334c-8.192 8.192-16.384 16.384-21.845333 24.576z m24.576-30.037334l-5.461334-5.461333 5.461334-5.461333c5.461333-5.461333 10.922667-13.653333 16.384-19.114667l5.461333 5.461333c-5.461333 5.461333-10.922667 10.922667-16.384 19.114667l-5.461333 5.461333z m27.306666-32.768l-5.461333-5.461333c8.192-8.192 13.653333-19.114667 19.114667-27.306667l5.461333 5.461334c-5.461333 10.922667-13.653333 19.114667-19.114667 27.306666zM150.186667 210.261333l-2.730667-8.192c8.192-2.730667 16.384-8.192 27.306667-13.653333l2.730666 8.192c-8.192 2.730667-19.114667 8.192-27.306666 13.653333zM185.685333 191.146667l-2.730666-5.461334c8.192-5.461333 19.114667-10.922667 30.037333-13.653333l2.730667 8.192c-10.922667 2.730667-19.114667 8.192-30.037334 10.922667z m939.349334-5.461334l-5.461334-5.461333c5.461333-10.922667 10.922667-19.114667 16.384-27.306667l8.192 2.730667c-5.461333 10.922667-10.922667 19.114667-19.114666 30.037333z m-901.12-10.922666L218.453333 166.570667c10.922667-2.730667 21.845333-8.192 32.768-10.922667l2.730667 8.192c-10.922667 2.730667-21.845333 5.461333-30.037333 10.922667z m35.498666-16.384l-2.730666-5.461334c10.922667-2.730667 19.114667-8.192 30.037333-10.922666l2.730667 8.192c-8.192 0-19.114667 5.461333-30.037334 8.192zM1146.88 147.456l-8.192-2.730667c2.730667-8.192 8.192-19.114667 8.192-30.037333l8.192 2.730667c-2.730667 10.922667-5.461333 21.845333-8.192 30.037333z m-849.237333-2.730667l-2.730667-8.192c10.922667-2.730667 19.114667-8.192 30.037333-10.922666l2.730667 8.192c-8.192 2.730667-19.114667 8.192-30.037333 10.922666z m38.229333-13.653333l-2.730667-8.192c10.922667-2.730667 21.845333-8.192 30.037334-10.922667l2.730666 8.192c-8.192 2.730667-19.114667 8.192-30.037333 10.922667z m38.229333-13.653333l-2.730666-8.192c10.922667-2.730667 21.845333-5.461333 30.037333-10.922667l5.461333 10.922667-32.768 8.192zM1157.802667 109.226667h-8.192v-8.192c0-8.192 0-13.653333-2.730667-21.845334l8.192-2.730666c2.730667 8.192 2.730667 16.384 2.730667 24.576V109.226667z m-742.741334-2.730667l-2.730666-8.192c10.922667-2.730667 21.845333-5.461333 30.037333-8.192l2.730667 8.192c-10.922667 0-21.845333 2.730667-30.037334 8.192z m38.229334-13.653333l-2.730667-8.192c10.922667-2.730667 21.845333-5.461333 30.037333-8.192l2.730667 8.192c-10.922667 2.730667-19.114667 5.461333-30.037333 8.192zM491.52 81.92l-2.730667-8.192 32.768-8.192 2.730667 8.192L491.52 81.92z m38.229333-8.192l-2.730666-8.192 32.768-8.192 2.730666 8.192-32.768 8.192z m614.4-2.730667c-5.461333-8.192-10.922667-16.384-19.114666-24.576l5.461333-5.461333c8.192 8.192 16.384 16.384 21.845333 27.306667l-8.192 2.730666z m-573.44-8.192l-2.730666-8.192 32.768-8.192V54.613333c-8.192 2.730667-19.114667 5.461333-30.037334 8.192z m38.229334-8.192l-2.730667-8.192 32.768-8.192 2.730667 8.192-32.768 8.192z m40.96-10.922666l-2.730667-8.192c10.922667-2.730667 21.845333-5.461333 32.768-5.461334l2.730667 8.192c-10.922667 2.730667-21.845333 5.461333-32.768 5.461334zM1119.573333 40.96c-8.192-5.461333-19.114667-10.922667-27.306666-13.653333V19.114667c10.922667 5.461333 21.845333 8.192 30.037333 16.384l-2.730667 5.461333z m-428.714666-5.461333l-2.730667-8.192c10.922667 0 21.845333-2.730667 32.768-5.461334l2.730667 8.192c-13.653333 2.730667-24.576 5.461333-32.768 5.461334z m38.229333-5.461334V21.845333c10.922667-2.730667 21.845333-2.730667 32.768-5.461333v8.192c-10.922667 2.730667-21.845333 2.730667-32.768 5.461333z m354.986667-5.461333c-10.922667-2.730667-19.114667-5.461333-30.037334-8.192l2.730667-8.192 32.768 8.192-5.461333 8.192zM770.048 24.576V16.384c10.922667-2.730667 21.845333-2.730667 32.768-5.461333v8.192c-10.922667 0-21.845333 2.730667-32.768 5.461333z m40.96-5.461333V10.922667c10.922667 0 21.845333-2.730667 32.768-2.730667v8.192c-10.922667 0-21.845333 0-32.768 2.730667z m232.106667-5.461334c-10.922667-2.730667-21.845333-2.730667-32.768-5.461333V0c10.922667 0 21.845333 2.730667 32.768 5.461333v8.192z m-193.877334 0V5.461333c10.922667 0 21.845333-2.730667 32.768-2.730666v8.192c-10.922667 0-21.845333 2.730667-32.768 2.730666z m40.96-2.730666V2.730667c10.922667 0 21.845333 0 32.768-2.730667v8.192c-10.922667 0-21.845333 0-32.768 2.730667z m114.688 0c-10.922667 0-21.845333-2.730667-32.768-2.730667V0c10.922667 0 21.845333 0 32.768 2.730667v8.192zM931.157333 8.192V0h32.768v8.192h-32.768z m150.186667 712.704v-8.192c5.461333 0 10.922667-2.730667 16.384-2.730667l2.730667 8.192c-5.461333 0-10.922667 2.730667-19.114667 2.730667z m0 0"
                fill="#D9D9D9" p-id="1562"></path>
              <path
                d="M966.656 106.496H316.757333s-49.152-5.461333-51.882666 51.882667c-2.730667 57.344 0 671.744 0 750.933333 0 65.536 90.112 79.189333 122.88 40.96 43.690667-46.421333 16.384-103.765333 5.461333-106.496-8.192-2.730667 608.938667 0 608.938667 0V180.224c-2.730667 0 5.461333-73.728-35.498667-73.728"
                fill="#FFFFFF" p-id="1563"></path>
              <path
                d="M333.141333 983.04c-24.576 0-46.421333-8.192-62.805333-24.576-13.653333-13.653333-19.114667-30.037333-19.114667-49.152v-122.88c0-204.8-2.730667-584.362667 0-630.784 2.730667-46.421333 32.768-62.805333 60.074667-62.805333h652.629333c10.922667 0 21.845333 5.461333 30.037334 13.653333 21.845333 24.576 16.384 70.997333 16.384 76.458667v674.474666H409.6c2.730667 5.461333 2.730667 8.192 5.461333 13.653334 5.461333 16.384 10.922667 54.613333-21.845333 90.112-13.653333 13.653333-35.498667 21.845333-60.074667 21.845333z m-19.114666-865.621333c-13.653333 0-38.229333 5.461333-38.229334 43.690666-2.730667 46.421333 0 425.984 0 628.053334v122.88c0 13.653333 5.461333 24.576 13.653334 35.498666 10.922667 10.922667 30.037333 19.114667 46.421333 19.114667 19.114667 0 35.498667-5.461333 43.690667-16.384 19.114667-21.845333 21.845333-43.690667 21.845333-57.344 0-16.384-8.192-30.037333-10.922667-32.768l-8.192-2.730667v-8.192c0-2.730667 0-5.461333 13.653334-8.192 16.384-2.730667 57.344-2.730667 150.186666-2.730666h445.098667v-655.36c2.730667-13.653333 2.730667-46.421333-10.922667-60.074667-2.730667-2.730667-8.192-5.461333-13.653333-5.461333H314.026667z m0 0"
                fill="#A9B1B6" p-id="1564"></path>
              <path
                d="M346.794667 229.376h570.709333v120.149333H346.794667V229.376z m0 174.762667h141.994666V436.906667h-141.994666v-32.768z m0 90.112h286.72v32.768H346.794667v-32.768z m0 90.112H518.826667v32.768h-172.032v-32.768z m0 98.304h346.794666v32.768H346.794667V682.666667z m35.498666 144.725333s60.074667 111.957333-51.882666 147.456c0 0-5.461333 0 0 0 240.298667 2.730667 480.597333 2.730667 720.896-2.730667 10.922667-2.730667 21.845333-8.192 30.037333-13.653333 5.461333-2.730667 19.114667-16.384 27.306667-35.498667 8.192-21.845333 10.922667-54.613333-10.922667-79.189333-5.461333-8.192-13.653333-13.653333-24.576-16.384H382.293333"
                fill="#EDEEEE" p-id="1565"></path>
              <path
                d="M617.130667 983.04c-95.573333 0-188.416 2.730667-283.989334 0l-16.384-2.730667 2.730667-13.653333v-2.730667h8.192c27.306667-8.192 46.421333-24.576 54.613333-43.690666 16.384-40.96-13.653333-84.650667-13.653333-84.650667l-5.461333-10.922667 712.704-5.461333h2.730666c10.922667 5.461333 19.114667 10.922667 27.306667 19.114667 21.845333 24.576 21.845333 62.805333 10.922667 87.381333-5.461333 16.384-16.384 27.306667-30.037334 38.229333-10.922667 8.192-21.845333 13.653333-32.768 16.384h-2.730666c-144.725333 2.730667-289.450667 2.730667-434.176 2.730667z m-251.221334-16.384c226.645333 2.730667 456.021333 0 682.666667-2.730667 8.192-2.730667 19.114667-8.192 27.306667-13.653333 10.922667-8.192 19.114667-19.114667 24.576-32.768 8.192-21.845333 8.192-51.882667-8.192-70.997333-5.461333-5.461333-10.922667-10.922667-19.114667-13.653334h-682.666667c8.192 19.114667 21.845333 57.344 8.192 92.842667-5.461333 16.384-16.384 30.037333-32.768 40.96z m0 0"
                fill="#A9B1B6" p-id="1566"></path>
              <path
                d="M1127.765333 688.128c-8.192-8.192-24.576-16.384-43.690666-16.384 0 0 21.845333 0 40.96-13.653333 10.922667-8.192 19.114667-24.576 19.114666-43.690667 0 0 0 27.306667 19.114667 46.421333 8.192 8.192 21.845333 13.653333 40.96 13.653334 0 0-21.845333 0-38.229333 13.653333-10.922667 8.192-19.114667 24.576-19.114667 43.690667-2.730667 0 0-24.576-19.114667-43.690667M54.613333 286.72c-10.922667-10.922667-30.037333-19.114667-54.613333-19.114667 0 0 30.037333 0 51.882667-19.114666 13.653333-10.922667 21.845333-30.037333 21.845333-57.344 0 0 0 35.498667 24.576 57.344 10.922667 10.922667 30.037333 19.114667 51.882667 19.114666 0 0-27.306667 0-49.152 19.114667-13.653333 10.922667-24.576 30.037333-24.576 57.344-2.730667-2.730667 0-35.498667-21.845334-57.344M1105.92 434.176c-5.461333-5.461333-10.922667-8.192-21.845333-8.192 0 0 10.922667 0 19.114666-8.192 5.461333-5.461333 10.922667-13.653333 10.922667-24.576 0 0 0 16.384 10.922667 24.576 5.461333 5.461333 10.922667 8.192 19.114666 8.192 0 0-10.922667 0-19.114666 8.192-5.461333 5.461333-10.922667 13.653333-10.922667 24.576 0 0 2.730667-13.653333-8.192-24.576"
                fill="#E79F9F" p-id="1567"></path>
              <path
                d="M1193.301333 595.285333c-5.461333-5.461333-13.653333-8.192-24.576-8.192 0 0 13.653333 0 24.576-8.192 5.461333-5.461333 10.922667-13.653333 10.922667-27.306666 0 0 0 16.384 10.922667 27.306666 5.461333 5.461333 13.653333 8.192 24.576 8.192 0 0-13.653333 0-24.576 8.192-5.461333 5.461333-10.922667 13.653333-10.922667 27.306667 0-2.730667 0-19.114667-10.922667-27.306667M917.504 778.24c-2.730667-2.730667-8.192-5.461333-13.653333-5.461333 0 0 8.192 0 13.653333-5.461334 2.730667-2.730667 5.461333-8.192 5.461333-16.384 0 0 0 10.922667 5.461334 16.384 2.730667 2.730667 8.192 5.461333 13.653333 5.461334 0 0-8.192 0-13.653333 5.461333-2.730667 2.730667-5.461333 8.192-5.461334 16.384 0-2.730667 2.730667-10.922667-5.461333-16.384"
                fill="#DC8484" p-id="1568"></path>
              <path
                d="M1067.690667 518.826667c0 65.536-38.229333 122.88-92.842667 147.456-21.845333 10.922667-155.648 60.074667-180.224 60.074666-27.306667 0 57.344-51.882667 35.498667-62.805333-54.613333-27.306667-90.112-84.650667-90.112-144.725333 0-90.112 73.728-163.84 163.84-163.84s163.84 73.728 163.84 163.84"
                fill="#F8E7E7" p-id="1569"></path>
              <path
                d="M794.624 740.010667c-10.922667 0-16.384-5.461333-16.384-8.192-5.461333-10.922667 5.461333-19.114667 21.845333-35.498667 5.461333-5.461333 16.384-16.384 19.114667-21.845333-57.344-30.037333-90.112-90.112-90.112-152.917334 0-98.304 79.189333-174.762667 177.493333-174.762666s174.762667 79.189333 174.762667 174.762666c0 68.266667-38.229333 131.072-101.034667 158.378667-19.114667 8.192-158.378667 60.074667-185.685333 60.074667z m109.226667-371.370667c-84.650667 0-152.917333 68.266667-152.917334 152.917333 0 57.344 32.768 109.226667 81.92 136.533334 5.461333 2.730667 8.192 8.192 10.922667 13.653333 2.730667 13.653333-10.922667 27.306667-27.306667 43.690667 43.690667-10.922667 131.072-43.690667 152.917334-54.613334 51.882667-24.576 87.381333-79.189333 87.381333-136.533333-2.730667-87.381333-68.266667-155.648-152.917333-155.648z m0 0"
                fill="#E79F9F" p-id="1570"></path>
              <path
                d="M846.506667 518.826667c0 10.922667-8.192 16.384-16.384 16.384-10.922667 0-16.384-8.192-16.384-16.384 0-10.922667 8.192-16.384 16.384-16.384s16.384 8.192 16.384 16.384"
                fill="#FCEAEA" p-id="1571"></path>
              <path
                d="M830.122667 546.133333c-10.922667 0-19.114667-5.461333-24.576-16.384-2.730667-10.922667-2.730667-21.845333 5.461333-27.306666 8.192-8.192 19.114667-10.922667 27.306667-5.461334 10.922667 2.730667 16.384 13.653333 16.384 24.576s-10.922667 24.576-24.576 24.576z m0-35.498666c-5.461333 0-8.192 5.461333-8.192 10.922666s2.730667 8.192 8.192 10.922667c5.461333 0 8.192-5.461333 8.192-10.922667 0-8.192-2.730667-10.922667-8.192-10.922666z m0 0"
                fill="#E79F9F" p-id="1572"></path>
              <path
                d="M917.504 518.826667c0 10.922667-8.192 16.384-16.384 16.384-10.922667 0-16.384-8.192-16.384-16.384 0-10.922667 8.192-16.384 16.384-16.384s16.384 8.192 16.384 16.384"
                fill="#FCEAEA" p-id="1573"></path>
              <path
                d="M898.389333 546.133333c-10.922667 0-19.114667-5.461333-24.576-16.384-2.730667-10.922667-2.730667-21.845333 5.461334-27.306666 8.192-8.192 19.114667-10.922667 27.306666-5.461334 10.922667 2.730667 16.384 13.653333 16.384 24.576 2.730667 10.922667-8.192 24.576-24.576 24.576z m0-35.498666c-2.730667 0-5.461333 2.730667-8.192 5.461333-2.730667 2.730667-2.730667 5.461333 0 10.922667 2.730667 2.730667 5.461333 5.461333 8.192 5.461333 5.461333 0 10.922667-5.461333 10.922667-10.922667 0-8.192-5.461333-10.922667-10.922667-10.922666z m0 0"
                fill="#E79F9F" p-id="1574"></path>
              <path
                d="M991.232 518.826667c0 5.461333-2.730667 10.922667-8.192 16.384-5.461333 2.730667-10.922667 2.730667-16.384 0-8.192-2.730667-10.922667-8.192-10.922667-16.384 0-10.922667 8.192-16.384 16.384-16.384s19.114667 8.192 19.114667 16.384"
                fill="#FCEAEA" p-id="1575"></path>
              <path
                d="M972.117333 546.133333c-10.922667 0-19.114667-5.461333-24.576-16.384-2.730667-10.922667-2.730667-21.845333 5.461334-27.306666 8.192-8.192 19.114667-10.922667 27.306666-5.461334 10.922667 2.730667 16.384 13.653333 16.384 24.576 2.730667 10.922667-10.922667 24.576-24.576 24.576z m0-35.498666c-2.730667 0-5.461333 2.730667-8.192 5.461333-2.730667 2.730667-2.730667 5.461333 0 10.922667 2.730667 2.730667 5.461333 5.461333 8.192 5.461333 5.461333 0 10.922667-5.461333 10.922667-10.922667 0-8.192-5.461333-10.922667-10.922667-10.922666z m0 0"
                fill="#E79F9F" p-id="1576"></path>
            </svg>
          </div>
          <span class="color-grey font-s-14">
            暂无数据
            </span>
        </div>
      </el-tab-pane>
    </el-tabs>
    <el-dialog :title="tips.title" :visible.sync="dialogVisible" width="30%">
      <el-form ref="form" :model="form" :rules="rules" label-width="90px">
        <el-form-item label="专栏名称:" prop="specialName">
          <el-input maxlength="20" show-word-limit v-model="form.specialName" placeholder="专栏名称"/>
        </el-form-item>
        <el-form-item label="简介:" prop="specialIntroduce">
          <el-input type="textarea" :rows="4" maxlength="200" show-word-limit v-model="form.specialIntroduce"
                    placeholder="专栏简介"/>
        </el-form-item>
        <el-form-item label="封面:">
          <imageUpload v-model="value" :limit="1"/>
        </el-form-item>
      </el-form>
      <span slot="footer" class="dialog-footer">
      <el-button @click="dialogVisible = false">取 消</el-button>
      <el-button :loading="buttonLoading" type="primary" @click="updates">{{ tips.button }}</el-button>
    </span>
    </el-dialog>
  </div>
</template>

<script>
export default {
  name: "specialManage.vue",
  data() {
    return {
      special: 'special',
      dialogVisible: false,
      buttonLoading: false,
      tips: {
        button: '更新专栏',
        title: '更 新',
        isAdd: false,
      },
      // 表单参数
      form: {},
      rules: {
        specialName: [
          {required: true, message: "名称不能为空", trigger: "blur"}
        ],
        specialIntroduce: [
          {required: true, message: "名称简介不能为空", trigger: "blur"}
        ],
      },
      cover: "",
      loading: true,
      specialUserList: [],
      queryParams: {
        uid: null,
        specialName: null,
      },
      value: [],
      debounceTimer: null,//防抖
      debounceTime: 400,//防抖时间
    }
  },
  watch: {
    'queryParams.specialName'() {
      this.specialListUids();
    },
  },
  methods: {
    specialIndex(item) {
      let routeInfo = this.$router.resolve({
        path: "/external_info/special",
        query: {id: this.$base64.encode(item.id), uuid: this.$base64.encode(item.uid)},
      });
      window.open(routeInfo.href, '_blank');
    },
    administration(item) {
      this.$router.push({
        path: '/user_admin/special/special-administration',
        query: {id: this.$base64.encode(item.id), title: item.specialName}
      })
    },
    deletes(item) {
      this.$modal.confirm('确认要删除《' + item.specialName + '》专栏吗？').then(() => {
        this.loading = true;
        return this.$API("/white/delete/special/" + item.id, "delete");
      }).then(() => {
        this.specialListUids();
        this.$modal.msgSuccess("删除成功");
      }).finally(() => this.loading = false)
    },
    add() {
      this.reset();
      this.tips.isAdd = true;
      this.tips.button = "添 加";
      this.tips.title = "添加专栏";
      this.dialogVisible = true;
    },
    edit(item) {
      this.reset();
      this.tips.isAdd = false;
      this.tips.button = "更 新";
      this.tips.title = "更新专栏";
      this.form = item;
      this.value = this.form.cover == null ? [] : [{url: this.form.cover,}];
      this.dialogVisible = true;
    },
    updates() {
      this.$refs["form"].validate(valid => {
        if (valid) {
          this.buttonLoading = true
          if (this.value.length > 0) {
            this.form.cover = this.value[0].url;
          }
          if (this.tips.isAdd) {
            this.$API("/special/information", "post", null, this.form).then(response => {
              if (response.code == 200) {
                this.$modal.msg("添加成功");
                this.specialListUids();
              }
            }).finally(() => {
              this.buttonLoading = false;
              this.dialogVisible = false;
            });
          } else {
            this.$API("/special/information", "put", null, this.form).then(response => {
              if (response.code == 200) {
                this.$modal.msg("更新成功");
                this.specialListUids();
              }
            }).finally(() => {
              this.buttonLoading = false;
              this.dialogVisible = false;
            });
          }
        }
      });
    },
    reset() {
      this.form = {
        id: undefined,
        specialName: undefined,
        specialIntroduce: undefined,
        state: undefined,
        uid: undefined,
        cover: undefined,
        createTime: undefined,
        updateId: undefined,
        updateTime: undefined
      };
      this.value = []
    },
    isCurrentUser() {
      this.$API("/front-desk/user/basics", "get").then(res => {
        if (res == null) {
          this.$router.push('/');
          return;
        }
        this.queryParams.uid = res.data.uuid;
        this.specialListUids()
      });
    },
    specialListUids() {
      clearTimeout(this.debounceTimer);
      this.debounceTimer = setTimeout(() => {
        this.$API("/white/special/list", "get", this.queryParams).then(res => {
          this.specialUserList = res.data;
          this.loading = false;
        })
      }, this.debounceTime);
    }
  },
  mounted() {
    this.isCurrentUser();
  }
}
</script>

<style scoped>
.home-top-index {
  background-color: #fefefe;
  border-radius: 4px;
  padding: 10px;
  min-height: 100px;
}

.hr_gradient {
  border: 0;
  height: 1px;
  background: #dcdfe6;
  margin-top: 6px;
  margin-bottom: 10px;
}

.left-loc-cl {
  cursor: pointer;
  margin-right: 26px;
  font-size: 16px;
}

.left-loc-cl:hover {
  color: var(--theme-color);
}

.details-1 {
  font-size: 18px;
  color: #2f3542;
  margin-bottom: 12px;
}

.details-2 {
  white-space: nowrap;
  overflow: hidden;
  font-size: 14px;
  text-overflow: ellipsis;
  margin-bottom: 12px;
}

.el-divider--horizontal {
  margin: 12px 0;
}

.details-3 {
  font-size: 14px;
}

.content {
  margin-top: 30px;
  background-color: #fefefe;
}

.contentItem {
  margin: 10px 0;
  padding: 4px 0;
}
</style>
